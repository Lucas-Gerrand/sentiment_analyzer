<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring-2.13.0.xsd
    ">
	<bean id="sentimentBean" class="at.tuwien.sentimentanalyzer.beans.SentimentBean" />
	<bean id="wordTagger" class="at.tuwien.sentimentanalyzer.beans.WordTagger" />
	<bean id="sentimentExtraction" class="at.tuwien.sentimentanalyzer.beans.SentimentBean" />
	<bean id="wordCounter" class="at.tuwien.sentimentanalyzer.beans.WordCounter" />
<!-- 	<bean id="reportCreator" class="at.tuwien.sentimentanalyzer.beans.ReportCreator" /> -->
	<!-- <bean id="commentsFilter" class="at.tuwien.sentimentanalyzer.beans.CommentsFilter" 
		/> -->



	<!-- this is the included XML file where we include only the routeContext -->
	<routeContext id="SentimentRoutes" xmlns="http://camel.apache.org/schema/spring">

		
		<route>
<!-- 			<from uri="file://searches/?delete=true"/> -->
<!-- 			<unmarshal> -->
<!-- 				<csv /> -->
<!-- 			</unmarshal> -->
			<from uri="direct:incomingMessages" />
			<bean ref="sentimentExtraction" />
			<to uri="log:result" />
		</route>

		<route>
			<from uri="seda:sentimentQueue?multipleConsumers=true" />
			<marshal>
				<csv />
			</marshal>
			<to uri="log:csv" />

			<!-- Note it simply overwrites the old file at the moment. Create a bean 
				to read the file and add the new data (I think) -->
			<to
				uri="file://sentimented/?fileName={{search.term}}_${date:now:yyyyMMddhhmmssSSS}.csv&amp;fileExist=Append" />

		</route>

		<route>
			<from
				uri="file://sentimented/share_20140527092217.csv?consumer.delay=1000" />
			<unmarshal>
				<csv />
			</unmarshal>
			<to uri="bean:wordCounter?method=WordCounter" />
			
			<marshal>
				<csv />
			</marshal>
			<to uri="log:csv" />

			<!-- Note it simply overwrites the old file at the moment. Create a bean 
				to read the file and add the new data (I think) -->
			<to
				uri="file://counted/?fileName={{search.term}}_WORDCOUNT_${date:now:yyyyMMddhhmmss}.csv&amp;fileExist=Append" />
		</route>

		<!-- TODO: add aggregator to from, change bean ref for csv-handler <route> 
			<from uri="bean:"/> <filter> <method ref="commentsFilter" method="filterURL"/> 
			<to uri="bean:sentimentExtraction"/> </filter> <bean ref="messageToMapBean"/> 
			<to uri="log:mapper" /> <marshal> <csv /> </marshal> <to uri="log:csv" /> 
			</route> -->


	</routeContext>

</beans>
